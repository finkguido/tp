<div class="w3-container" style="margin-top:70px">
    <div class="w3-container" style="margin:auto; margin-top:2rem">


        <form action="/tp/quiz/answer" method="post">

            <!-- pregunta -->
            <div class="w3-panel w3-amber w3-round-large w3-card-4 w3-padding-16">
                <div class="w3-center w3-small">
                    <span class="w3-tag {{question.category_class}} w3-round w3-text-white">{{question.category_name}}</span>
                    <h2 class="w3-center"><b>{{question.question_text}}</b></h2>
                </div>
            </div>

            <!-- respuestas -->
            <div class="w3-content" style="margin-top:70px">
                <div class="w3-row-padding w3-margin-top">
                    {{#options}}
                        <div class="w3-padding-large w3-half w3-margin-bottom">
                            <div class="w3-panel w3-deep-purple w3-round-large w3-card w3-padding-16"
                                 style="height:100%; min-height:120px; display:flex; align-items:center; justify-content:center">
                                <label style="width:100%; cursor:pointer">
                                    <input type="radio" name="answer" value="{{id}}" class="w3-radio" required>
                                    <span class="w3-large">{{answer_text}}</span>
                                </label>
                            </div>
                        </div>
                    {{/options}}
                </div>
            </div>

            <!-- puntaje y botÃ³n -->
            <div class="w3-content">
                <div class="w3-row-padding w3-margin-top">
                    <div class="w3-padding-large w3-margin-bottom">

                        <div class="w3-row">
                            <div class="w3-half">
                                <span class="w3-large"><strong>Puntos: {{score}}</strong></span>
                            </div>
                            <div class="w3-half w3-right-align">
                                <input type="hidden" name="question_id" value="{{question.id}}">
                                <button class="w3-button w3-green w3-round-large w3-padding" type="submit">
                                    <i class="fa fa-paper-plane"></i> Enviar respuesta
                                </button>
                            </div>

                            <div class="w3-half w3-center w3-text-red">
                                <span class="w3-large"><strong>Tiempo restante: <span id="countdown">20</span>s</strong></span>
                            </div>

                        </div>
                    </div>
                    </div>
                </div>
            </div>

        </form>

    </div>
</div>

<script>
    let timeLeft = 20;
    const countdownEl = document.getElementById('countdown');

    const timer = setInterval(() => {
        timeLeft--;
        if (countdownEl) {
            countdownEl.textContent = timeLeft;
        }

        if (timeLeft <= 0) {
            clearInterval(timer);

            const selected = document.querySelector('input[name="answer"]:checked');
            if (selected) {
                document.querySelector('form').submit();
            } else {
                window.location.href = "/tp/quiz/finish"; //termina si no termino
            }
        }
    }, 1000);
</script>

